{{ template "base.html" . }}

{{ define "content" }}
<div class="row">
    <!-- Vista General de HostAPD -->
    <div class="col-12 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-router"></i>
                    {{ call .t "hostapd.overview" "Overview" }}
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <i class="bi bi-wifi text-primary" style="font-size: 2rem;"></i>
                            <h6 class="mt-2">{{ call .t "hostapd.access_points" "Access Points" }}</h6>
                            <h4 class="text-primary">{{ if .hostapd_stats.access_points_count }}{{ .hostapd_stats.access_points_count }}{{ else }}2{{ end }}</h4>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <i class="bi bi-people text-success" style="font-size: 2rem;"></i>
                            <h6 class="mt-2">{{ call .t "hostapd.clients" "Clients" }}</h6>
                            <h4 class="text-success">{{ if .hostapd_stats.clients_count }}{{ .hostapd_stats.clients_count }}{{ else }}8{{ end }}</h4>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <i class="bi bi-speedometer2 text-warning" style="font-size: 2rem;"></i>
                            <h6 class="mt-2">{{ call .t "hostapd.bandwidth" "Bandwidth" }}</h6>
                            <h4 class="text-warning">{{ if .hostapd_stats.total_bandwidth }}{{ .hostapd_stats.total_bandwidth }}{{ else }}150 Mbps{{ end }}</h4>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <i class="bi bi-shield-check text-info" style="font-size: 2rem;"></i>
                            <h6 class="mt-2">{{ call .t "hostapd.security" "Security" }}</h6>
                            <h4 class="text-info">{{ call .t "hostapd.active" "Active" }}</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Estado de HostAPD -->
    <div class="col-md-4 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-heart-pulse"></i>
                    {{ call .t "hostapd.status" "Status" }}
                </h5>
            </div>
            <div class="card-body">
                <div class="d-flex align-items-center mb-3">
                    <span class="status-indicator status-{{ if .hostapd_status.enabled }}online{{ else }}offline{{ end }}"></span>
                    <span>{{ if .hostapd_status.enabled }}{{ call .t "hostapd.hostapd_enabled" "Enabled" }}{{ else }}{{ call .t "hostapd.hostapd_disabled" "Disabled" }}{{ end }}</span>
                </div>
                
                <div class="d-flex align-items-center mb-3">
                    <span class="status-indicator status-{{ if .hostapd_status.running }}online{{ else }}offline{{ end }}"></span>
                    <span>{{ if .hostapd_status.running }}{{ call .t "hostapd.hostapd_running" "Running" }}{{ else }}{{ call .t "hostapd.hostapd_stopped" "Stopped" }}{{ end }}</span>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">{{ call .t "hostapd.active_access_points" "Active APs" }}</label>
                    <div class="d-flex align-items-center">
                        <i class="bi bi-wifi text-primary me-2"></i>
                        <span class="h6 mb-0">{{ if .hostapd_status.active_aps }}{{ .hostapd_status.active_aps }}{{ else }}2{{ end }}</span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">{{ call .t "hostapd.connected_clients" "Connected Clients" }}</label>
                    <div class="d-flex align-items-center">
                        <i class="bi bi-people text-success me-2"></i>
                        <span class="h6 mb-0">{{ if .hostapd_status.connected_clients }}{{ .hostapd_status.connected_clients }}{{ else }}8{{ end }}</span>
                    </div>
                </div>
                
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-success" onclick="toggleHostAPD()">
                        <i class="bi bi-router"></i>
                        {{ if .hostapd_status.enabled }}{{ call .t "hostapd.disable_hostapd" "Disable HostAPD" }}{{ else }}{{ call .t "hostapd.enable_hostapd" "Enable HostAPD" }}{{ end }}
                    </button>
                    <button class="btn btn-outline-primary" onclick="restartHostAPD()">
                        <i class="bi bi-arrow-clockwise"></i>
                        {{ call .t "hostapd.restart_hostapd" "Restart HostAPD" }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Puntos de Acceso -->
    <div class="col-md-8 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-wifi"></i>
                    {{ call .t "hostapd.access_points" "Access Points" }}
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>{{ call .t "hostapd.access_point_name" "Name" }}</th>
                                <th>{{ call .t "hostapd.access_point_ssid" "SSID" }}</th>
                                <th>{{ call .t "hostapd.access_point_status" "Status" }}</th>
                                <th>{{ call .t "hostapd.access_point_clients" "Clients" }}</th>
                                <th>{{ call .t "common.actions" "Actions" }}</th>
                            </tr>
                        </thead>
                        <tbody id="accessPointsTable">
                            <!-- Los puntos de acceso se cargarán dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Clientes Conectados -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-people"></i>
                    {{ call .t "hostapd.clients" "Clients" }}
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>{{ call .t "hostapd.client_mac" "MAC Address" }}</th>
                                <th>{{ call .t "hostapd.client_ip" "IP Address" }}</th>
                                <th>{{ call .t "hostapd.client_signal" "Signal" }}</th>
                                <th>{{ call .t "hostapd.client_uptime" "Uptime" }}</th>
                            </tr>
                        </thead>
                        <tbody id="clientsTable">
                            <!-- Los clientes se cargarán dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Configuración de HostAPD -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-gear"></i>
                    {{ call .t "hostapd.configuration" "Configuration" }}
                </h5>
            </div>
            <div class="card-body">
                <form id="hostapdConfigForm">
                    <div class="mb-3">
                        <label for="interface" class="form-label">{{ call .t "hostapd.interface" "Interface" }}</label>
                        <select class="form-select" id="interface" name="interface">
                            <option value="wlan0" {{ if eq .hostapd_config.interface "wlan0" }}selected{{ end }}>wlan0</option>
                            <option value="wlan1" {{ if eq .hostapd_config.interface "wlan1" }}selected{{ end }}>wlan1</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label for="ssid" class="form-label">{{ call .t "hostapd.access_point_ssid" "SSID" }}</label>
                        <input type="text" class="form-control" id="ssid" name="ssid" value="{{ if .hostapd_config.ssid }}{{ .hostapd_config.ssid }}{{ else }}HostBerry-AP{{ end }}">
                    </div>
                    
                    <div class="mb-3">
                        <label for="password" class="form-label">{{ call .t "hostapd.access_point_password" "Password" }}</label>
                        <input type="password" class="form-control" id="password" name="password" value="{{ if .hostapd_config.password }}{{ .hostapd_config.password }}{{ end }}">
                    </div>
                    
                    <div class="mb-3">
                        <label for="channel" class="form-label">{{ call .t "hostapd.access_point_channel" "Channel" }}</label>
                        <select class="form-select" id="channel" name="channel">
                            {{ range $i := Seq 1 13 }}
                            <option value="{{ $i }}" {{ if eq $.hostapd_config.channel $i }}selected{{ end }}>{{ $i }}</option>
                            {{ end }}
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label for="security" class="form-label">{{ call .t "hostapd.access_point_security" "Security" }}</label>
                        <select class="form-select" id="security" name="security">
                            <option value="wpa2" {{ if eq .hostapd_config.security "wpa2" }}selected{{ end }}>WPA2</option>
                            <option value="wpa3" {{ if eq .hostapd_config.security "wpa3" }}selected{{ end }}>WPA3</option>
                            <option value="open" {{ if eq .hostapd_config.security "open" }}selected{{ end }}>Open</option>
                        </select>
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle"></i>
                            {{ call .t "common.save" "Save" }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Estadísticas de HostAPD -->
    <div class="col-12 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-graph-up"></i>
                    {{ call .t "hostapd.statistics" "Statistics" }}
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <h6>{{ call .t "hostapd.total_traffic" "Total Traffic" }}</h6>
                            <h4 class="text-primary">{{ if .hostapd_stats.total_traffic }}{{ .hostapd_stats.total_traffic }}{{ else }}2.8 GB{{ end }}</h4>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <h6>{{ call .t "hostapd.active_clients" "Active Clients" }}</h6>
                            <h4 class="text-success">{{ if .hostapd_stats.active_clients }}{{ .hostapd_stats.active_clients }}{{ else }}8{{ end }}</h4>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <h6>{{ call .t "hostapd.peak_bandwidth" "Peak Bandwidth" }}</h6>
                            <h4 class="text-warning">{{ if .hostapd_stats.peak_bandwidth }}{{ .hostapd_stats.peak_bandwidth }}{{ else }}75 Mbps{{ end }}</h4>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <h6>{{ call .t "hostapd.uptime" "Uptime" }}</h6>
                            <h4 class="text-info">{{ if .hostapd_stats.uptime }}{{ .hostapd_stats.uptime }}{{ else }}5 días{{ end }}</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{ end }}

{{ define "extra_js" }}
<script src="/static/js/hostapd.js?v={{ .last_update }}"></script>
{{ end }}
