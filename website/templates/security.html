{% extends "base.html" %}

{% block content %}
<div class="dashboard-container">
    <!-- Header Section -->
    <div class="dashboard-header mb-4">
        <div class="row align-items-center">
            <div class="col-12 text-center">
                <h1 class="dashboard-title">
                    <i class="bi bi-hdd-network me-2"></i>
                    {{ t('navigation.backup', 'Backup') }}
                </h1>
                <p class="dashboard-subtitle">{{ t('backup.subtitle', 'Gestiona y restaura tus respaldos del sistema') }}</p>
                <div class="dashboard-time">
                    <i class="bi bi-clock me-1"></i>
                    {{ t('backup.last_check', 'Última verificación') }}: <span id="backup-last-check">--</span>
                </div>
            </div>
        </div>
    </div>



    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="actions-card">
                <div class="actions-card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="actions-card-title">
                            <i class="bi bi-lightning-charge me-2"></i>
                            {{ t('backup.actions_heading', 'Acciones de backup') }}
                        </h5>
                        <button class="btn btn-sm btn-outline-light" id="backupsRefresh">
                            <i class="bi bi-arrow-clockwise me-1"></i>{{ t('common.refresh', 'Refresh') }}
                        </button>
                    </div>
                </div>
                <div class="actions-card-body">
                    <div class="quick-actions">
                        <button class="action-btn action-backup" id="action-create-backup">
                            <i class="bi bi-hdd-network"></i>
                            <span>{{ t('backup.create_backup', 'Crear backup') }}</span>
                        </button>
                        <label class="action-btn action-backup" id="action-upload-backup" style="cursor: pointer; margin: 0;">
                            <input type="file" id="backup-file-input" accept=".tar.gz,.tgz" style="display: none;">
                            <i class="bi bi-cloud-upload"></i>
                            <span>{{ t('backup.upload_backup', 'Cargar backup') }}</span>
                        </label>
                        <button class="action-btn action-backup" id="action-list-backups">
                            <i class="bi bi-archive"></i>
                            <span>{{ t('backup.list_backups', 'Listar backups') }}</span>
                        </button>
                        <button class="action-btn action-backup" id="action-backup-stats">
                            <i class="bi bi-graph-up"></i>
                            <span>{{ t('backup.stats', 'Estadísticas') }}</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Backup Inventory -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="actions-card">
                <div class="actions-card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="actions-card-title">
                                <i class="bi bi-archive me-2"></i>
                                {{ t('backup.inventory_heading', 'Inventario de backups') }}
                            </h5>
                            <p class="text-white-50 mb-0 small">{{ t('backup.inventory_caption', 'Últimos backups almacenados en el dispositivo') }}</p>
                        </div>
                        <button class="btn btn-sm btn-outline-light" id="backupsListRefresh">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    </div>
                </div>
                <div class="actions-card-body">
                    <div class="backup-list" id="security-backup-list">
                        <div class="text-center py-4 text-white-50">
                            <i class="bi bi-database"></i>
                            <p class="mb-0 mt-2">{{ t('backup.no_backups', 'Aún no hay backups listados') }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
(function(){
  const setBadge = (id, enabled) => {
    const el = document.getElementById(id);
    if(!el) return;
    const isOn = !!enabled;
    const enabledText = HostBerry.t?.('security.enabled', 'Enabled') || 'Enabled';
    const disabledText = HostBerry.t?.('security.disabled', 'Disabled') || 'Disabled';
    el.className = 'badge ' + (isOn ? 'bg-success' : 'bg-danger');
    el.textContent = isOn ? enabledText : disabledText;
  };

  const setStatusCard = (idPrefix, enabled) => {
    const badgeEl = document.getElementById(idPrefix + '-badge');
    if(badgeEl) {
      const badge = badgeEl.querySelector('.badge');
      if(badge) {
        badge.className = 'badge ' + (enabled ? 'bg-success' : 'bg-danger');
        badge.textContent = enabled 
          ? (HostBerry.t?.('security.enabled', 'Enabled') || 'Enabled')
          : (HostBerry.t?.('security.disabled', 'Disabled') || 'Disabled');
      }
    }
  };

  const setText = (id, value) => {
    const el = document.getElementById(id);
    if(el){ el.textContent = value; }
  };

  async function updateLastCheck(){
    setText('backup-last-check', new Date().toLocaleString());
  }


  // Función de notificaciones como en dashboard
  function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
      <div class="notification-content">
        <span class="notification-message">${message}</span>
        <button class="notification-close" onclick="this.parentElement.parentElement.remove()">×</button>
      </div>
    `;
    
    if (!document.querySelector('#notification-styles')) {
      const style = document.createElement('style');
      style.id = 'notification-styles';
      style.textContent = `
        .notification {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          min-width: 300px;
          padding: 1rem;
          border-radius: 12px;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.2);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
          animation: slideInRight 0.3s ease;
        }
        .notification-content {
          display: flex;
          justify-content: space-between;
          align-items: center;
          color: #fff;
        }
        .notification-close {
          background: none;
          border: none;
          color: #fff;
          font-size: 1.2rem;
          cursor: pointer;
          padding: 0;
          margin-left: 1rem;
        }
        .notification-success { border-left: 4px solid #198754; }
        .notification-error { border-left: 4px solid #dc3545; }
        .notification-warning { border-left: 4px solid #ffc107; }
        .notification-info { border-left: 4px solid #0dcaf0; }
        @keyframes slideInRight {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        body.light-theme .notification {
          background: rgba(255, 255, 255, 0.95);
          color: #212529;
          border: 1px solid rgba(0, 0, 0, 0.1);
        }
        body.light-theme .notification-content {
          color: #212529;
        }
        body.light-theme .notification-close {
          color: #212529;
        }
      `;
      document.head.appendChild(style);
    }
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      if (notification.parentElement) {
        notification.remove();
      }
    }, 5000);
  }

  async function createBackup(){
    try{
      const confirmMsg = HostBerry.t?.('backup.create_confirm', '¿Estás seguro de que quieres crear un backup?') || '¿Estás seguro de que quieres crear un backup?';
      if(!confirm(confirmMsg)) return;
      
      showNotification(HostBerry.t?.('backup.creating', 'Creando backup...') || 'Creando backup...', 'info');
      
      const resp = await HostBerry.apiRequest('/api/v1/security/backup?include_logs=true&include_uploads=true', { method: 'POST' });
      if(!resp.ok){
        const errorText = await resp.text();
        throw new Error(errorText || 'Backup failed');
      }
      const payload = await resp.json();
      const message = payload.message || payload.data?.message || HostBerry.t?.('backup.created', 'Backup creado exitosamente') || 'Backup creado exitosamente';
      showNotification(message, 'success');
      updateLastCheck();
      await loadBackups();
    }catch(error){
      console.error('Backup failed', error);
      const errorMsg = HostBerry.t?.('backup.create_error', 'Error al crear backup') || 'Error al crear backup';
      showNotification(errorMsg, 'error');
    }
  }

  async function loadBackups(){
    const list = document.getElementById('security-backup-list');
    if(!list) return;
    try{
      const resp = await HostBerry.apiRequest('/api/v1/security/backups');
      if(!resp.ok) throw new Error('Backups request failed');
      const payload = await resp.json();
      const backups = payload.data?.backups || payload.backups || [];
      if(!backups.length){
        list.innerHTML = `
          <div class="text-center py-4 text-white-50">
            <i class="bi bi-archive"></i>
            <p class="mb-0 mt-2">${HostBerry.t?.('security.no_backups', 'No backups listed yet') || 'No backups listed yet'}</p>
          </div>`;
        return;
      }
      list.innerHTML = '';
      backups.slice(0, 10).forEach(backup => {
        const item = document.createElement('div');
        item.className = 'backup-item text-white';
        const name = backup.name || backup.filename || backup.path || (typeof backup === 'string' ? backup : 'backup');
        const size = backup.size ? formatBytes(backup.size) : '';
        const date = backup.created_at || backup.timestamp || backup.date || backup.created || '';
        const formattedDate = date ? new Date(date).toLocaleString() : '';
        item.innerHTML = `
          <div class="d-flex justify-content-between align-items-center gap-3">
            <div class="flex-grow-1 min-w-0">
              <div class="d-flex align-items-center gap-2 mb-1">
                <i class="bi bi-file-earmark-zip text-primary"></i>
                <strong class="backup-name" title="${name}">${name}</strong>
              </div>
              <div class="d-flex align-items-center gap-3 text-white-50 small">
                ${formattedDate ? `<span><i class="bi bi-calendar3 me-1"></i>${formattedDate}</span>` : ''}
                ${size ? `<span><i class="bi bi-hdd me-1"></i>${size}</span>` : ''}
              </div>
            </div>
            <div class="d-flex align-items-center gap-2 flex-shrink-0">
              <button class="btn btn-sm btn-outline-info info-backup-btn" data-backup-name="${name}" title="${HostBerry.t?.('backup.info', 'Información') || 'Información'}">
                <i class="bi bi-info-circle"></i>
              </button>
              <button class="btn btn-sm btn-outline-primary download-backup-btn" data-backup-name="${name}" title="${HostBerry.t?.('backup.download', 'Descargar') || 'Descargar'}">
                <i class="bi bi-download"></i>
              </button>
              <button class="btn btn-sm btn-outline-warning restore-backup-btn" data-backup-name="${name}" title="${HostBerry.t?.('backup.restore', 'Restaurar') || 'Restaurar'}">
                <i class="bi bi-arrow-clockwise"></i>
              </button>
              <button class="btn btn-sm btn-outline-danger delete-backup-btn" data-backup-name="${name}" title="${HostBerry.t?.('backup.delete', 'Eliminar') || 'Eliminar'}">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>`;
        list.appendChild(item);
      });
      
      // Agregar event listeners a los botones
      document.querySelectorAll('.info-backup-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const backupName = btn.getAttribute('data-backup-name');
          showBackupInfo(backupName);
        });
      });
      
      document.querySelectorAll('.download-backup-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const backupName = btn.getAttribute('data-backup-name');
          downloadBackup(backupName);
        });
      });
      
      document.querySelectorAll('.restore-backup-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const backupName = btn.getAttribute('data-backup-name');
          restoreBackup(backupName);
        });
      });
      
      document.querySelectorAll('.delete-backup-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const backupName = btn.getAttribute('data-backup-name');
          deleteBackup(backupName);
        });
      });
    }catch(error){
      console.error('Backups load failed', error);
      list.innerHTML = `
        <div class="text-center py-4 text-danger">
          <i class="bi bi-exclamation-triangle"></i>
          <p class="mb-0 mt-2">${HostBerry.t?.('security.backups_error', 'Unable to load backups') || 'Unable to load backups'}</p>
        </div>`;
    }
  }

  function formatBytes(bytes){
    if(!bytes || bytes === 0) return '';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
  }


  async function downloadBackup(backupName){
    try{
      if(!backupName){
        showNotification(HostBerry.t?.('errors.backup_not_found', 'Backup no encontrado') || 'Backup no encontrado', 'error');
        return;
      }
      
      showNotification(HostBerry.t?.('backup.downloading', 'Descargando backup...') || 'Descargando backup...', 'info');
      
      // Crear enlace de descarga
      const downloadUrl = `/api/v1/security/backup/${encodeURIComponent(backupName)}/download`;
      const link = document.createElement('a');
      link.href = downloadUrl;
      link.download = backupName;
      link.style.display = 'none';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      // Esperar un momento y mostrar mensaje de éxito
      setTimeout(() => {
        showNotification(HostBerry.t?.('backup.downloaded', 'Backup descargado exitosamente') || 'Backup descargado exitosamente', 'success');
        updateLastCheck();
      }, 500);
      
    }catch(error){
      console.error('Backup download failed', error);
      showNotification(HostBerry.t?.('backup.download_error', 'Error al descargar backup') || 'Error al descargar backup', 'error');
    }
  }

  async function uploadBackup(file){
    try{
      if(!file){
        showNotification(HostBerry.t?.('backup.no_file', 'No se seleccionó ningún archivo') || 'No se seleccionó ningún archivo', 'error');
        return;
      }
      
      // Validar extensión
      if(!file.name.endsWith('.tar.gz') && !file.name.endsWith('.tgz')){
        showNotification(HostBerry.t?.('backup.invalid_format', 'El archivo debe ser un backup .tar.gz') || 'El archivo debe ser un backup .tar.gz', 'error');
        return;
      }
      
      showNotification(HostBerry.t?.('backup.uploading', 'Cargando backup...') || 'Cargando backup...', 'info');
      
      const formData = new FormData();
      formData.append('file', file);
      
      // Usar fetch directamente para FormData (no establecer Content-Type, el navegador lo hace automáticamente)
      const token = localStorage.getItem('access_token');
      const resp = await fetch('/api/v1/security/backup/upload', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`
        },
        body: formData
      });
      
      if(!resp.ok){
        const errorData = await resp.json().catch(() => ({ detail: await resp.text() }));
        throw new Error(errorData.detail || errorData.message || 'Upload failed');
      }
      
      const payload = await resp.json();
      const message = payload.message || payload.data?.message || HostBerry.t?.('backup.uploaded', 'Backup cargado exitosamente') || 'Backup cargado exitosamente';
      showNotification(message, 'success');
      updateLastCheck();
      await loadBackups();
      
    }catch(error){
      console.error('Backup upload failed', error);
      const errorMsg = HostBerry.t?.('backup.upload_error', 'Error al cargar backup') || 'Error al cargar backup';
      showNotification(errorMsg, 'error');
    }
  }

  async function restoreBackup(backupName){
    try{
      if(!backupName){
        showNotification(HostBerry.t?.('errors.backup_not_found', 'Backup no encontrado') || 'Backup no encontrado', 'error');
        return;
      }
      
      // Confirmación doble para restauración
      const confirmMsg1 = HostBerry.t?.('backup.restore_confirm', '¿Estás seguro de que quieres restaurar este backup? Esto reemplazará los datos actuales del sistema.') || '¿Estás seguro de que quieres restaurar este backup? Esto reemplazará los datos actuales del sistema.';
      if(!confirm(confirmMsg1)) return;
      
      const confirmMsg2 = HostBerry.t?.('backup.restore_confirm_final', '¡ADVERTENCIA! Esta acción restaurará el backup y reemplazará los datos actuales. ¿Estás absolutamente seguro?') || '¡ADVERTENCIA! Esta acción restaurará el backup y reemplazará los datos actuales. ¿Estás absolutamente seguro?';
      if(!confirm(confirmMsg2)) return;
      
      showNotification(HostBerry.t?.('backup.restoring', 'Restaurando backup...') || 'Restaurando backup...', 'warning');
      
      const resp = await HostBerry.apiRequest(`/api/v1/security/backup/${encodeURIComponent(backupName)}/restore`, {
        method: 'POST'
      });
      
      if(!resp.ok){
        const errorText = await resp.text();
        throw new Error(errorText || 'Restore failed');
      }
      
      const payload = await resp.json();
      const message = payload.message || payload.data?.message || HostBerry.t?.('backup.restored', 'Backup restaurado exitosamente') || 'Backup restaurado exitosamente';
      showNotification(message, 'success');
      
      // Recargar la lista de backups después de un momento
      setTimeout(() => {
        loadBackups();
      }, 2000);
      
    }catch(error){
      console.error('Backup restore failed', error);
      const errorMsg = HostBerry.t?.('backup.restore_error', 'Error al restaurar backup') || 'Error al restaurar backup';
      showNotification(errorMsg, 'error');
    }
  }

  async function showBackupInfo(backupName){
    try{
      if(!backupName){
        HostBerry.showAlert?.('danger', HostBerry.t?.('errors.backup_not_found', 'Backup not found') || 'Backup not found');
        return;
      }
      
      const resp = await HostBerry.apiRequest(`/api/v1/security/backup/${encodeURIComponent(backupName)}`);
      if(!resp.ok) throw new Error('Info request failed');
      
      const payload = await resp.json();
      const info = payload.data?.backup_info || payload.backup_info || {};
      
      const infoText = `
        <strong>${HostBerry.t?.('backup.name', 'Nombre')}:</strong> ${backupName}<br>
        <strong>${HostBerry.t?.('backup.size', 'Tamaño')}:</strong> ${info.size ? formatBytes(info.size) : 'N/A'}<br>
        <strong>${HostBerry.t?.('backup.created', 'Creado')}:</strong> ${info.created_at || info.timestamp || 'N/A'}<br>
        <strong>${HostBerry.t?.('backup.path', 'Ruta')}:</strong> ${info.path || 'N/A'}
      `;
      
      HostBerry.showAlert?.('info', infoText);
    }catch(error){
      console.error('Backup info failed', error);
      HostBerry.showAlert?.('danger', HostBerry.t?.('backup.info_error', 'Error al obtener información') || 'Error al obtener información');
    }
  }

  async function deleteBackup(backupName){
    try{
      if(!backupName){
        HostBerry.showAlert?.('danger', HostBerry.t?.('errors.backup_not_found', 'Backup not found') || 'Backup not found');
        return;
      }
      
      const confirmMsg = HostBerry.t?.('backup.delete_confirm', '¿Estás seguro de que quieres eliminar este backup?') || '¿Estás seguro de que quieres eliminar este backup?';
      if(!confirm(confirmMsg)) return;
      
      HostBerry.showAlert?.('info', HostBerry.t?.('backup.deleting', 'Eliminando backup...') || 'Eliminando backup...');
      
      // Nota: Necesitarías crear un endpoint DELETE /api/v1/security/backup/{backup_name}
      // Por ahora, mostramos un mensaje de que esta funcionalidad está en desarrollo
      HostBerry.showAlert?.('warning', HostBerry.t?.('backup.delete_not_implemented', 'Función de eliminación en desarrollo') || 'Función de eliminación en desarrollo');
      
    }catch(error){
      console.error('Backup delete failed', error);
      HostBerry.showAlert?.('danger', HostBerry.t?.('backup.delete_error', 'Error al eliminar backup') || 'Error al eliminar backup');
    }
  }

  async function showBackupStats(){
    try{
      const resp = await HostBerry.apiRequest('/api/v1/security/backups');
      if(!resp.ok) throw new Error('Stats request failed');
      
      const payload = await resp.json();
      const backups = payload.data?.backups || payload.backups || [];
      
      const totalBackups = backups.length;
      const totalSize = backups.reduce((sum, b) => sum + (b.size || 0), 0);
      const oldestBackup = backups.length > 0 ? backups[backups.length - 1] : null;
      const newestBackup = backups.length > 0 ? backups[0] : null;
      
      const statsText = `
        <strong>${HostBerry.t?.('backup.total', 'Total de backups')}:</strong> ${totalBackups}<br>
        <strong>${HostBerry.t?.('backup.total_size', 'Tamaño total')}:</strong> ${formatBytes(totalSize)}<br>
        ${oldestBackup ? `<strong>${HostBerry.t?.('backup.oldest', 'Backup más antiguo')}:</strong> ${oldestBackup.name || oldestBackup.filename || 'N/A'}<br>` : ''}
        ${newestBackup ? `<strong>${HostBerry.t?.('backup.newest', 'Backup más reciente')}:</strong> ${newestBackup.name || newestBackup.filename || 'N/A'}` : ''}
      `;
      
      HostBerry.showAlert?.('info', statsText);
    }catch(error){
      console.error('Backup stats failed', error);
      HostBerry.showAlert?.('danger', HostBerry.t?.('backup.stats_error', 'Error al obtener estadísticas') || 'Error al obtener estadísticas');
    }
  }

  document.addEventListener('DOMContentLoaded', function(){
    updateLastCheck();
    loadBackups();
    
    document.getElementById('backupsRefresh')?.addEventListener('click', loadBackups);
    document.getElementById('backupsListRefresh')?.addEventListener('click', loadBackups);
    document.getElementById('action-create-backup')?.addEventListener('click', createBackup);
    document.getElementById('action-list-backups')?.addEventListener('click', loadBackups);
    document.getElementById('action-backup-stats')?.addEventListener('click', showBackupStats);
    
    // Manejar carga de archivo
    const fileInput = document.getElementById('backup-file-input');
    if(fileInput){
      fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if(file){
          uploadBackup(file);
          // Resetear input
          e.target.value = '';
        }
      });
    }
    
    setInterval(loadBackups, 30000);
  });
})();
</script>
<style>
.spinning {
    animation: spin 1s linear infinite;
}
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}
.log-item {
    padding: 0.75rem 1rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    gap: 1rem;
    align-items: center;
    margin-bottom: 0.75rem;
}
.log-item:last-child {
    margin-bottom: 0;
}
.log-level {
    min-width: 80px;
    text-transform: uppercase;
    font-size: 0.7rem;
}
.backup-item {
    padding: 0.75rem 1rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.05);
    margin-bottom: 0.75rem;
    transition: all 0.3s ease;
}
.backup-item:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}
.backup-item:last-child {
    margin-bottom: 0;
}
.backup-name {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
    word-break: break-all;
}
.backup-item .min-w-0 {
    min-width: 0;
}
.backup-item .flex-shrink-0 {
    flex-shrink: 0;
}
.logs-container {
    max-height: 380px;
    overflow-y: auto;
}
.backup-action-btn {
    height: 140px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 20px;
    border-radius: 16px;
    transition: all 0.3s ease;
    border: 2px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.03);
}

.backup-action-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);
    border-color: rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.05);
}

.backup-btn-icon {
    width: 56px;
    height: 56px;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.75rem;
    background: rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.backup-action-btn:hover .backup-btn-icon {
    transform: scale(1.1) rotate(5deg);
    background: rgba(255, 255, 255, 0.2);
}

.backup-btn-content {
    text-align: center;
    width: 100%;
}

.backup-btn-title {
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 4px;
}

.backup-btn-desc {
    font-size: 0.85rem;
    opacity: 0.75;
    line-height: 1.3;
}

.backup-item {
    padding: 1rem 1.25rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.05);
    margin-bottom: 0.75rem;
    transition: all 0.3s ease;
}

.backup-item:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(255, 255, 255, 0.15);
    transform: translateX(4px);
}

.backup-item:last-child {
    margin-bottom: 0;
}

.backup-name {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
    word-break: break-all;
    font-size: 0.95rem;
}

.backup-item .min-w-0 {
    min-width: 0;
}

.backup-item .flex-shrink-0 {
    flex-shrink: 0;
}
</style>
{% endblock %}
